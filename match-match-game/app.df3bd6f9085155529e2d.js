(()=>{"use strict";class t{constructor(t){this.requestListener=t}requestStateChange(t){return this.requestListener(t)}}const e="http://www.w3.org/2000/svg";class s{constructor({hookElement:t,...e}){this.element=function({tag:t="div",classNames:e,text:s}){const i=document.createElement(t);return Array.isArray(e)&&i.classList.add(...e),s&&(i.textContent=s),i}(e),t&&t(this.element)}getText(){return this.element.textContent}setText(t){this.element.textContent=t}clear(){return this.element.innerHTML="",this}render(t){return this.clear(),Array.isArray(t)?this.element.append(...t.map((t=>t.element))):this.element.append(t.element),this}setCssState(t,e=!0){this.element.classList.toggle(t,e)}setCssStateAsync(t,e=!0){return this.element.classList.toggle(t,e),new Promise((t=>{this.element.addEventListener("transitionend",(()=>t()),{once:!0})}))}getCssVar(t){return function(t,e){return getComputedStyle(t).getPropertyValue(e)}(this.element,t)}setCssVar(t,e){!function(t,e,s){t.style.setProperty(e,s)}(this.element,t,e)}onClick(t,e){this.element.addEventListener("click",t,e)}}class i extends s{constructor({classNames:t,...e}){super({...e,tag:"button",classNames:["btn"].concat(t||[])})}active(t=!0){this.setCssState("btn--active",t)}}class a extends s{constructor({url:t,classNames:e,...s}){super({...s,tag:"a",classNames:["link"].concat(e||[])}),this.element.href=t}active(t=!0){this.setCssState("link--active",t)}}class r{static view({tag:t,childs:e,hookView:n,...o}){let c;switch(t){case"a":case"img":c=new a(o);break;case"button":c=new i(o);break;default:c=new s({tag:t,...o})}if(n&&n(c),e){const t=e.map((t=>t instanceof s?t:r.view(t)));c.render(t)}return c}}const n={page:"page--1AFmu1ZbC"};class o{constructor({classNames:t,...e}){this.view=r.view({classNames:[n.page].concat(t||[]),...e})}init(){console.log(this,"âš ï¸ Method INIT not implemented âš ï¸")}stop(){console.log(this,"âš ï¸ Method STOP not implemented âš ï¸")}}class c extends o{constructor(){super({childs:[{tag:"h1",text:c.name}]})}}const h={12:{cardField:[4,3],initialShowTime:3,scoreCoefficient:1},16:{cardField:[4,4],initialShowTime:4,scoreCoefficient:1.1},20:{cardField:[5,4],initialShowTime:5,scoreCoefficient:1.2},24:{cardField:[6,4],initialShowTime:6,scoreCoefficient:1.4},30:{cardField:[6,5],initialShowTime:8,scoreCoefficient:1.7},36:{cardField:[6,6],initialShowTime:10,scoreCoefficient:2},42:{cardField:[7,6],initialShowTime:12,scoreCoefficient:2.5},48:{cardField:[8,6],initialShowTime:15,scoreCoefficient:3},56:{cardField:[8,7],initialShowTime:20,scoreCoefficient:3.5},64:{cardField:[8,8],initialShowTime:25,scoreCoefficient:4}},l="card__side--1YnFocLsV";class d extends s{constructor(t){super({classNames:["card-container--i0yIuD8uN"]});const e=r.view({classNames:[l,"card__side--back--1vG-3cHdj"]});e.element.style.backgroundImage=`url("./images/${t.backImage}")`;const s=r.view({classNames:[l,"card__side--front--1toEdlg30"]});s.element.style.backgroundImage=`url("./images/${t.frontImage}")`;const i=r.view({classNames:["card--19lZCi7QM"],childs:[e,s]});this.render(i)}flip(t=!0){return this.setCssState("flipped--2EZsq6Spb",t),new Promise((t=>{this.element.addEventListener("transitionend",(()=>t()),{once:!0})}))}error(t=!0){this.setCssState("error--3HGSMKD5U",t)}match(t=!0){this.setCssState("match--1yCHxpwpW",t)}}class u{constructor(t){this.model=t,this.view=new d(t),this.model.onStateChange((t=>this.updateView(t)))}onClick(t){this.view.onClick((()=>t(this)))}async updateView(t){this.view.error(t.isError),this.view.match(t.isMatch),await this.view.flip(t.isFrontSide)}}const m="--cards-columns",p="--cards-rows";class g{constructor(){this.view=r.view({classNames:["cards-field--1SU6hNcue"]})}render(t,e){this.view.clear();const[s,i]=h[e].cardField;this.columns=s,this.rows=i,this.view.render(t.map((t=>t.view)))}get columns(){return Number(this.view.getCssVar(m))}set columns(t){this.view.setCssVar(m,String(t))}get rows(){return Number(this.view.getCssVar(p))}set rows(t){this.view.setCssVar(p,String(t))}}class w{constructor(){this.listenersMap=new Map}subscribe(t,e){this.listenersMap.has(t)||this.listenersMap.set(t,new Set),this.listenersMap.get(t)?.add(e)}unsubscribe(t,e){this.listenersMap.get(t)?.delete(e)}notify(t,e){this.listenersMap.get(t)?.forEach((t=>t(e)))}}class v{constructor(t){this.observer=new w,this.state=this.proxify(t)}getState(){return{...this.state}}onStateChange(t){this.observer.subscribe("state-change",t)}proxify(t){return new Proxy(t,{set:(t,e,s)=>(t[e]=s,this.observer.notify("state-change",this.getState()),this.observer.notify(e,s),!0)})}static logChangeState(t,e,s){return`Changin ${String(t)} property ${e} from ${String(t[e])} to ${String(s)}`}}class S extends v{constructor(t){super({isError:!1,isStopped:!0,isSolved:!1,gameActiveCard:void 0,matchedCards:new Set,startTime:new Date,stopTime:new Date}),this.cards=t,this.gameObserver=new w,this.cards=t}flipAll(t){this.cards.forEach((e=>e.flip(t)))}onSolved(t){this.gameObserver.subscribe("game-solved",t)}showAllCards(){this.flipAll(!0)}start(){this.flipAll(!1),this.state.isStopped=!1,this.state.startTime=new Date}stop(){this.state.isStopped=!0,this.state.stopTime=new Date}get activeCard(){return this.state.gameActiveCard}async cardClickHandler(t){return!(this.state.isStopped||this.state.isError||this.state.matchedCards.has(t)||t===this.state.gameActiveCard||(t.click(),this.state.gameActiveCard?(this.match(t)||await this.error(t),0):(this.state.gameActiveCard=t,0)))}match(t){return t.frontImage===this.state.gameActiveCard?.frontImage&&(this.state.gameActiveCard.match(!0),t.match(!0),this.state.matchedCards.add(this.state.gameActiveCard),this.state.matchedCards.add(t),this.state.gameActiveCard=void 0,this.state.matchedCards.size===this.cards.length&&(this.state.isSolved=!0,this.stop(),this.gameObserver.notify("game-solved",this.state)),!0)}async error(t){this.state.isError=!0,await Promise.all([this.state.gameActiveCard?.error(),t.error()]),this.state.isError=!1,this.state.gameActiveCard=void 0}get clicks(){const[t,e]=this.cards.reduce((([t,e],s)=>{const{clickedCount:i,errorCount:a}=s.getState();return[t+i,e+a]}),[0,0]);return{all:t,error:e}}get score(){const{all:t,error:e}=this.clicks,s=t-e,i=this.state.isStopped?this.state.stopTime:new Date,a=100*s-10*Math.round((i.getTime()-this.state.startTime.getTime())/1e3);return a<0?0:a}}class C extends v{constructor(t,e,s){super({isError:!1,isMatch:!1,isFrontSide:!1,clickedCount:0,errorCount:0}),this.id=t,this.frontImage=e,this.backImage=s}flip(t){this.state.isMatch||this.state.isError||(this.state.isFrontSide=t)}match(t){this.state.isMatch=t}async error(){this.state.isMatch||(this.state.errorCount+=1,this.state.isError=!0,await(2e3,new Promise((t=>setTimeout(t,2e3)))),this.state.isError=!1,this.flip(!1))}click(){this.state.isMatch||this.state.isError||this.state.isFrontSide||(this.flip(!0),this.state.clickedCount+=1)}}function f(t){const e=t%60;return[e,(t-e)/60]}function b(t){const{hours:e,min:s,sec:i}=function(t){const[e,s]=f(t),[i,a]=f(s);return{hours:a,min:i,sec:e,diff:t}}(t);return{hours:String(e).padStart(2,"0"),min:String(s).padStart(2,"0"),sec:String(i).padStart(2,"0"),diff:t}}class y extends v{constructor(){super({startTime:0,currentTime:0,getTimeDiff(){return b(this.currentTime-this.startTime)}})}reset(t=0){window.clearInterval(this.timerId),this.state.startTime=0,this.state.currentTime=t}stop(){return window.clearInterval(this.timerId),this.getTimeDiff()}start(t=0){this.reset(t),this.timerId=window.setInterval((()=>this.increment()),1e3)}async countdown(t=10){return new Promise((e=>{this.reset(t),this.timerId=window.setInterval((()=>{this.decrement(),this.state.currentTime>0||(this.reset(),e())}),1e3)}))}increment(){this.state.currentTime+=1}decrement(){this.state.currentTime-=1}getTimeDiff(){return b(this.state.currentTime-this.state.startTime)}}const N="timer__output--2TxoOB91B";class x extends s{constructor(t=":"){super({classNames:["timer--3hmDgpm1E"]}),this.output={seconds:r.view({classNames:[N,"timer__output--seconds--m2fBlsDJB"]}),minutes:r.view({classNames:[N,"timer__output--minutes--1dMtRHovH"]}),hours:r.view({classNames:[N,"timer__output--hours--11f_qoGHw"]})},this.render(r.view({classNames:["timer__box--22sYiA39u"],childs:[this.output.hours,x.createSplitter(t),this.output.minutes,x.createSplitter(t),this.output.seconds]}))}show(t){this.output.seconds.element.textContent=t.sec,this.output.minutes.element.textContent=t.min,t.hours&&(this.output.hours.element.textContent=t.hours)}static createSplitter(t=":"){return r.view({classNames:[N,"timer__output--splitter--3RPQD9d0b"],text:t})}stop(t=!0){this.setCssState("timer--stop--3hJx4Xln3",t)}countdown(t=!0){this.setCssState("timer--countdown--1I-_ImbQN",t)}reset(){this.stop(!1),this.countdown(!1)}}class k{constructor(){this.view=new x,this.model=new y,this.updateView(this.model.getState()),this.model.onStateChange((t=>this.updateView(t)))}updateView(t){this.view.show(t.getTimeDiff())}start(){this.view.reset(),this.model.start()}stop(){this.model.stop(),this.view.stop()}reset(){this.model.reset(),this.view.reset()}async countdown(t=10){this.view.countdown(),await this.model.countdown(t)}}const _="game--solved--2M0U5Nryc";class A extends o{constructor(t,e){super({classNames:["game--3_WFWXfxo"]}),this.gameSettingsService=t,this.cardImagesService=e,this.timer=new k,this.cardsField=new g,this.cards=[],this.view.render([this.timer.view,this.cardsField.view])}init(){this.newGame().then(null,null)}stop(){this.stopGame()}stopGame(){this.timer.reset(),this.model?.stop(),this.model=void 0,this.cards=[],this.cardsField.view.clear(),this.view.setCssState(_,!1)}async newGame(){this.stopGame();const t=await this.gameSettingsService.loadSettings(),e=await this.cardImagesService.getUrls(t.cardImagesCategory,t.cardsAmount);if(!e)return;const s=e.front.map(((t,s)=>new C(s,t,e.back)));this.cards=s.map((t=>new u(t))),this.cards.forEach((t=>t.onClick((()=>this.cardClickHandler(t))))),this.cardsField.render(this.cards,t.cardsAmount),this.model=new S(s),this.model.showAllCards(),await this.timer.countdown(h[t.cardsAmount].initialShowTime),this.model.start(),this.timer.start(),this.model.onSolved((()=>{this.timer.stop(),this.view.setCssState(_,!0)}))}async cardClickHandler(t){return!!this.model&&this.model.cardClickHandler(t.model)}}function T(t){const e=t;for(let t=e.length-1;t>0;t-=1){const s=Math.floor((t+1)*Math.random());[e[s],e[t]]=[e[t],e[s]]}return e}const I="./images.json";var L;!function(t){t.cats="ðŸ± Cats ðŸˆðŸˆâ€â¬›",t.dogs="ðŸ¶ Dogs ðŸ•ðŸ©ðŸ•â€ðŸ¦º"}(L||(L={}));const U={"select-container":"select-container--2qMqk-kXI",selectContainer:"select-container--2qMqk-kXI","select-label":"select-label--3OgUUngdK",selectLabel:"select-label--3OgUUngdK",selector:"selector--2mb9FNFi6",option:"option--3JZjhnarx"};class M extends s{constructor({heading:t,placeholder:e,classNames:s,...i}){super({...i,classNames:[U.selectContainer].concat(s||[])}),this.label=r.view({tag:"label",classNames:[U.selectLabel]}),this.select=r.view({tag:"select",classNames:[U.selector]}),this.placeholder=M.createOption({value:"placeholder",text:"placeholder",selected:!0,disabled:!0}),this.render([this.label,this.select]),this.label.setText(t),this.placeholder.setText(e),this.select.render(this.placeholder)}addOptions(t){return this.select.render([this.placeholder,...t.map((t=>M.createOption(t)))]),this}static createOption({value:t,text:e,selected:s,disabled:i}){const a=r.view({tag:"option",classNames:[U.option]});return a.element.setAttribute("value",t),a.setText(e),s&&a.element.setAttribute("selected","selected"),i&&a.element.setAttribute("disabled","disabled"),a}onSelect(t,e){const s=this.select.element;s.addEventListener("input",(()=>t(s.value)),e)}}class E extends v{constructor(t){super({...t})}setSetting(t,e){this.state[t]=e}}const F="settings__select--BAwgzNiED";class P extends o{constructor(t){super({classNames:["settings--C-VaPZFRX"]}),this.gameSettingsService=t,this.selectGameCards=new M({heading:"game cards",placeholder:"select game cards type",classNames:[F]}),this.selectDifficulty=new M({heading:"difficulty",placeholder:"select game type",classNames:[F]}),this.view.render(r.view({classNames:["settings-wrapper--2pEsVn9hO"],childs:[this.selectDifficulty,this.selectGameCards]})),this.gameSettingsService.loadSettings().then((t=>{this.model=new E(t),this.model.onStateChange((t=>this.gameSettingsService.saveSettings(t))),this.initSelectsors(this.model.getState())}),null)}initSelectsors(t){const e=Object.entries(L).map((e=>({value:e[0],text:String(e[1]),selected:t.cardImagesCategory===e[0]})));this.selectGameCards.addOptions(e);const s=Object.entries(h).map((e=>{const s=`${e[1].cardField[0]} Ã— ${e[1].cardField[1]}`,i=String(e[1].initialShowTime).padStart(2,"Â "),a=Math.floor(100*e[1].scoreCoefficient);return{value:e[0],text:`ðŸŽ´ ${s} Â |Â  Start â³ ${i}s Â |Â  Score ðŸ† Ã— ${a}%`,selected:t.cardsAmount.toString()===e[0]}}));this.selectDifficulty.addOptions(s),this.selectGameCards.onSelect((t=>this.model?.setSetting("cardImagesCategory",t))),this.selectDifficulty.onSelect((t=>this.model?.setSetting("cardsAmount",t)))}}class R extends o{constructor(){super({childs:[{tag:"h1",text:R.name}]})}}class V extends o{constructor(){super({childs:[{tag:"h1",text:V.name}]})}}class B{constructor(t,e){this.storageKey=t,this.initialSettings=e}loadSettings(){return new Promise((t=>{const e=window.localStorage.getItem(this.storageKey);t(null===e?this.initialSettings:JSON.parse(e))}))}saveSettings(t){return new Promise((e=>{window.localStorage.setItem(this.storageKey,JSON.stringify(t)),e()}))}}const O=new class{constructor(){this.jsonUrl=I}async fetch(){if(!this.cache){const t=await fetch(I),e=await t.json();this.cache=e.reduce(((t,e)=>t.set(e.category,e.images)),new Map)}return this.cache}async generateUrls(t){const e=(await this.fetch()).get(t);if(e)return{front:Array.from({length:e.last-e.first},((s,i)=>`${t}/${String(i+e.first).padStart(e.leftPad,e.leftPadChar)}.${e.extension}`)),back:e.cardCover}}async getUrls(t,e){const s=await this.generateUrls(t);if(!s)return;let{front:i}=s;return i=T(i).slice(0,e/2),i=T(i.concat(i)),{front:i,back:s.back}}},D=new class{constructor(t){this.initialSettings=t,this.localStorage=new B("fronte-finem__match-match-game___game-settings",t)}loadSettings(){return this.localStorage.loadSettings()}saveSettings(t){return this.localStorage.saveSettings(t)}}({cardImagesCategory:"dogs",cardsAmount:20}),q={url:"#/about-game",title:"about game",pageCreator:()=>new c},H={initialRoute:q,pages:{about:{route:q,navSvgIcon:"./svg/sprite.svg#icon-question-mark"},score:{route:{url:"#/best-score",title:"best score",pageCreator:()=>new R},navSvgIcon:"./svg/sprite.svg#icon-star"},settings:{route:{url:"#/game-settings",title:"game settings",pageCreator:()=>new P(D)},navSvgIcon:"./svg/sprite.svg#icon-gear"},game:{route:{url:"#/game",title:"about game",pageCreator:()=>new A(D,O)}}},header:{btn:{signUp:"register new player",start:"start game",stop:"stop game"}}};class ${constructor(){this.listeners=new Set}subscribe(t){this.listeners.add(t)}unsubscribe(t){this.listeners.delete(t)}notify(t){this.listeners.forEach((e=>e(t)))}}function G(t){return`${t[0].toUpperCase()}${t.slice(1).toLowerCase()}`}const j={url:"#/â›”",title:"Page Not Found!",pageCreator:()=>new V};class W{constructor(){this.observer=new $,this.routes=new Map,this.errorPageRoute=j,this.currentUrl="",window.addEventListener("hashchange",(()=>this.observer.notify(this.updateCurrentRoute())))}onChange(t){this.observer.subscribe(t)}addRoute(t){return this.routes.set(t.url,t),this}getPageRoute(t){return this.routes.get(t)||this.errorPageRoute}updateCurrentRoute(){const t=this.currentUrl,e=W.getCurrentUrl();if(t!==e){const t=this.getPageRoute(e);s=t.title,s.split(" ").map(G).join(" "),this.currentPage?.stop(),this.currentPage=t.pageCreator(),this.currentPage.init(),this.currentUrl=e}var s;return{oldUrl:t,newUrl:e,newPage:this.currentPage}}static getCurrentUrl(){return window.location.hash||""}static activateRoute(t){window.location.hash=t}}class Z extends s{constructor(){super({tag:"nav",classNames:["nav-menu--oq7N5R5oz"]}),this.navList=r.view({tag:"ul",classNames:["nav-items--ClElNpQa4"]}),this.render(this.navList)}addNavLinks(t){this.navLinks=t.filter((t=>void 0!==t.navSvgIcon)).reduce(((t,e)=>t.set(e.route.url,Z.createNavLink(e))),new Map),this.navList.render(Z.createNavItems([...this.navLinks.values()]))}setActiveNavLink(t){this.activeNavLink?.active(!1),this.activeNavLink=this.navLinks?.get(t),this.activeNavLink?.active()}static createNavItems(t){return t.map((t=>r.view({tag:"li",classNames:["nav-item--tNzLKtmzy"],childs:[t]})))}static createNavLink({route:t,navSvgIcon:s}){return new a({url:t.url,classNames:["nav-link--3vlnkh93B"],text:t.title,hookElement:t=>(s&&t.append(function(t,s){const i=document.createElementNS(e,"svg"),a=document.createElementNS(e,"use");return a.setAttribute("href",t),i.append(a),i.classList.add("svg-icon"),Array.isArray(s)&&i.classList.add(...s),i}(s,["svg-icon--2ZlcA-p-O"])),t)})}}class Q{constructor(t){this.initialState=t,this.statesMap=new Map,this.currentState=t,this.addState(t)}addState(t){return this.statesMap.set(t.name,t),this}getCurrentState(){return this.currentState.name}applyCurrentState(t){this.currentState.apply(t)}nextState(t,e=!0){const s=this.currentState,i=this.statesMap.get(s.next)||this.initialState;this.currentState=i,this.applyCurrentState(t),e&&t.observer.notify(s.name,[s.name,i.name])}}class X extends class{constructor(t,e){this.name=t,this.next=e}apply(t){throw new Error(`âš ï¸ Method not implemented. This state: ${String(this.name)}. This context: ${String(t)} âš ï¸`)}}{constructor(t,e,s,i){super(t,e),this.name=t,this.next=e,this.btnText=s,this.hideAvatar=i}apply(t){t.setBtnText(this.btnText),t.hideAvatar(this.hideAvatar)}}class K extends s{constructor(t){super({tag:"header",classNames:["header--1NncKmEQQ"]}),this.appStateService=t,this.observer=new w,this.stateMashine=new Q(new X("initial","ready",H.header.btn.signUp,!0)).addState(new X("ready","game",H.header.btn.start,!1)).addState(new X("game","ready",H.header.btn.stop,!1)),this.logo=new a({url:H.initialRoute.url,classNames:["logo--3qnSiQFY3"]}),this.menu=new Z,this.avatar=new a({url:"#/score",classNames:["avatar--1ZdwmxlvE"]}),this.btnStateSwitch=new i({classNames:["btn--2XTPIrVcX","btn-state-switch--1kI9X1ZWl"]}),this.render(r.view({classNames:["wrapper--3rfyi-BeM"],childs:[this.logo,this.menu,this.btnStateSwitch,this.avatar]})),this.stateMashine.applyCurrentState(this),this.btnStateSwitch.onClick((()=>{t.requestStateChange(this.getCurrentState()).then((t=>{t&&this.stateMashine.nextState(this)}),null)}))}getCurrentState(){return this.stateMashine.getCurrentState()}nextState(){this.stateMashine.nextState(this,!1)}hideAvatar(t=!0){this.avatar.setCssState("avatar--hidden--16fndReds",t)}setBtnText(t){this.btnStateSwitch.setText(t)}}const z="hidden--3NyI22jWd",J="root--modal-mode--24Uf6g9cD";class Y extends s{constructor(){super({classNames:["modal-cover--2OW8-d3HV",z]})}async show(){await this.setCssStateAsync(z,!1),document.body.classList.add(J)}async hide(){await this.setCssStateAsync(z,!0),document.body.classList.remove(J)}}const tt={"pop-up":"pop-up--YriWNg8R0",popUp:"pop-up--YriWNg8R0",hidden:"hidden--2yEgepIqC","pop-up__side":"pop-up__side--25PtkCbPW",popUpSide:"pop-up__side--25PtkCbPW","pop-up__header":"pop-up__header--30ffs2ZuF",popUpHeader:"pop-up__header--30ffs2ZuF","pop-up__footer":"pop-up__footer--l6g4pGxFS",popUpFooter:"pop-up__footer--l6g4pGxFS","pop-up__headedig":"pop-up__headedig--sR5LLqUE8",popUpHeadedig:"pop-up__headedig--sR5LLqUE8","pop-up__body":"pop-up__body--2XaS7WQjB",popUpBody:"pop-up__body--2XaS7WQjB"};class et extends s{constructor(t){super({tag:"section",classNames:[tt.popUp,tt.hidden]}),this.header=r.view({tag:"header",classNames:[tt.popUpSide,tt.popUpHeader]}),this.footer=r.view({tag:"footer",classNames:[tt.popUpSide,tt.popUpFooter]}),this.body=r.view({classNames:[tt.popUpBody]}),this.render([this.header,this.body,this.footer]),this.header.render(r.view({tag:"h3",classNames:[tt.popUpHeading],text:t}))}addContent(t){this.body.render(t)}addButtons(t){this.footer.render(t)}async show(){await this.setCssStateAsync(tt.hidden,!1)}async hide(){await this.setCssStateAsync(tt.hidden,!0)}async process(){return await this.show(),new Promise((t=>{this.onClick((()=>{this.hide().then((()=>t(!0)),null)}),{once:!0})}))}}class st{constructor(e){this.headerView=new K(new t((t=>this.handleAppStateChangeRequest(t)))),this.modalView=new Y,this.router=new W,this.gameStoppedByButton=!1,Object.values(H.pages).reduce(((t,e)=>t.addRoute(e.route)),this.router),this.router.onChange((t=>this.applayRouteChange(t))),this.initHeader(),this.pageContainer=new s({classNames:["page-container--2BzkQwOZo"]}),this.view=r.view({tag:"main",classNames:["app--2_KmwgIsG"],childs:[this.headerView,this.pageContainer,this.modalView]}),e.append(this.view.element)}start(){W.activateRoute(H.initialRoute.url),this.headerView.menu.setActiveNavLink(H.initialRoute.url)}applayRouteChange({oldUrl:t,newUrl:e,newPage:s}){t!==H.pages.game.route.url||this.gameStoppedByButton||this.headerView.nextState(),s&&this.pageContainer.render(s.view),this.headerView.menu.setActiveNavLink(e)}initHeader(){this.headerView.menu.addNavLinks(Object.values(H.pages))}async handleAppStateChangeRequest(t){switch(console.log(t),await new Promise((t=>t(!0))),t){case"initial":return await this.processInitialAppState();case"ready":return this.gameStoppedByButton=!1,W.activateRoute(H.pages.game.route.url),!0;case"game":return W.getCurrentUrl()===H.pages.game.route.url&&(this.gameStoppedByButton=!0,W.activateRoute(H.initialRoute.url)),!0;default:return!1}}async processInitialAppState(){const t=new et("Registr new Player");this.modalView.render(t),await this.modalView.show(),this.modalView.onClick((()=>{t.hide().then((()=>this.modalView.hide())).then(null,null)}));const e=await t.process();return await this.modalView.hide(),e}}window.addEventListener("load",(()=>{document.body.classList.add("root"),new st(document.body).start()}))})();